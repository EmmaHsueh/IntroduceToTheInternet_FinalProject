{"ast":null,"code":"// src/services/postService.js\n// 這個檔案專門處理貼文相關的 Firestore 操作\n\nimport { collection,\n// 用來指定集合\naddDoc,\n// 新增文件\ngetDocs,\n// 取得所有文件（一次性）\ngetDoc,\n// 🔥 新增：取得單一文件\nquery,\n// 建立查詢\nwhere,\n// 查詢條件\norderBy,\n// 排序\nonSnapshot,\n// 即時監聽資料變化\ndoc,\n// 指定特定文件\nupdateDoc,\n// 更新文件\nTimestamp // Firestore 時間戳記\n} from 'firebase/firestore';\nimport { db } from '../firebase';\n\n// ==========================================\n// 📖 原理解說：\n// ==========================================\n// Firestore 的核心操作分為兩種：\n// 1. 「一次性讀取」：getDocs() - 只取得當下的資料\n// 2. 「即時監聽」：onSnapshot() - 資料有變化時自動更新\n\n// 我們會使用 onSnapshot()，這樣當其他用戶發文時\n// 你的畫面會自動即時更新！\n\n// ==========================================\n// 🔹 功能 1：取得指定看板的所有貼文（即時監聽）\n// ==========================================\n/**\n * 監聽指定看板的貼文，並在資料變化時即時更新\n *\n * @param {string} boardName - 看板名稱（例如 \"Food\"）\n * @param {function} callback - 當資料變化時會呼叫這個函數，傳入最新的貼文陣列\n * @returns {function} unsubscribe - 呼叫這個函數可以停止監聽\n *\n * 使用範例：\n * const unsubscribe = listenToPosts(\"Food\", (posts) => {\n *   console.log(\"收到最新貼文:\", posts);\n *   setPosts(posts); // 更新 React state\n * });\n *\n * // 當組件卸載時，停止監聽\n * return () => unsubscribe();\n */\nexport const listenToPosts = (boardName, callback) => {\n  try {\n    // 1. 建立對 posts collection 的參照\n    const postsRef = collection(db, 'posts');\n\n    // 2. 建立查詢：只取得指定看板的貼文，並按時間排序（新的在前）\n    const q = query(postsRef, where('boardName', '==', boardName),\n    // 篩選條件：看板名稱\n    orderBy('createdAt', 'desc') // 排序：最新的在最上面\n    );\n\n    // 3. 開始監聽這個查詢\n    // 🔑 重點：onSnapshot 會在以下情況觸發：\n    //    - 第一次呼叫時（回傳現有資料）\n    //    - 有新貼文新增時\n    //    - 有貼文被修改時\n    //    - 有貼文被刪除時\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const posts = [];\n\n      // 4. 遍歷所有文件，將資料轉換成我們需要的格式\n      snapshot.forEach(doc => {\n        posts.push({\n          id: doc.id,\n          // 文件 ID\n          ...doc.data() // 文件內的所有資料\n        });\n      });\n\n      // 5. 呼叫 callback，把最新資料傳出去\n      callback(posts);\n    }, error => {\n      console.error('監聽貼文時發生錯誤:', error);\n      // 如果發生錯誤，回傳空陣列\n      callback([]);\n    });\n\n    // 6. 回傳取消監聽的函數\n    return unsubscribe;\n  } catch (error) {\n    console.error('設定監聽時發生錯誤:', error);\n    return () => {}; // 回傳空函數避免錯誤\n  }\n};\n\n// ==========================================\n// 🔹 功能 2：新增貼文到 Firestore\n// ==========================================\n/**\n * 新增一篇貼文到 Firestore\n *\n * @param {object} postData - 貼文資料\n * @param {string} postData.title - 標題\n * @param {string} postData.content - 內容\n * @param {string} postData.boardName - 看板名稱\n * @param {string} postData.authorId - 作者 UID\n * @param {string} postData.authorName - 作者名稱\n * @param {array} postData.imageUrls - 圖片網址陣列\n * @returns {Promise<string>} 回傳新建立的文件 ID\n *\n * 使用範例：\n * const newPostId = await createPost({\n *   title: \"美味午餐\",\n *   content: \"今天吃了好吃的拉麵\",\n *   boardName: \"Food\",\n *   authorId: currentUser.uid,\n *   authorName: \"小明\",\n *   imageUrls: [\"data:image/png;base64,...\"]\n * });\n */\nexport const createPost = async postData => {\n  try {\n    // 1. 準備要存入 Firestore 的資料\n    const newPost = {\n      title: postData.title,\n      content: postData.content,\n      boardName: postData.boardName,\n      authorId: postData.authorId,\n      authorName: postData.authorName,\n      imageUrls: postData.imageUrls || [],\n      createdAt: Timestamp.now(),\n      // 使用 Firestore 伺服器時間\n      commentCount: 0,\n      // 初始留言數為 0\n      comments: [] // 初始留言陣列為空\n    };\n\n    // 2. 將資料新增到 posts collection\n    // 🔑 重點：addDoc 會自動產生一個唯一的 document ID\n    const docRef = await addDoc(collection(db, 'posts'), newPost);\n    console.log('✅ 貼文已成功新增到 Firestore，ID:', docRef.id);\n\n    // 3. 回傳新建立的文件 ID\n    return docRef.id;\n  } catch (error) {\n    console.error('❌ 新增貼文時發生錯誤:', error);\n    throw error; // 將錯誤往上拋，讓呼叫的地方可以處理\n  }\n};\n\n// ==========================================\n// 🔹 功能 3：更新貼文的留言\n// ==========================================\n/**\n * 新增留言到指定的貼文\n *\n * @param {string} postId - 貼文 ID\n * @param {object} comment - 留言資料\n * @param {string} comment.author - 留言者名稱\n * @param {string} comment.content - 留言內容\n * @returns {Promise<void>}\n *\n * 使用範例：\n * await addCommentToPost(\"abc123\", {\n *   author: \"小華\",\n *   content: \"看起來好好吃！\"\n * });\n */\nexport const addCommentToPost = async (postId, comment) => {\n  try {\n    // 1. 取得指定貼文的參照\n    const postRef = doc(db, 'posts', postId);\n\n    // 2. 先取得現有的貼文資料 - 🔥 修正：使用 getDoc 而不是 getDocs\n    const postSnapshot = await getDoc(postRef);\n    if (!postSnapshot.exists()) {\n      throw new Error('找不到指定的貼文');\n    }\n    const postData = postSnapshot.data();\n    const existingComments = postData.comments || [];\n\n    // 3. 準備新留言資料\n    const newComment = {\n      id: Date.now().toString(),\n      author: comment.author,\n      content: comment.content,\n      date: new Date().toLocaleString('zh-TW')\n    };\n\n    // 4. 更新貼文：新增留言並增加留言數量\n    // 🔑 重點：updateDoc 只會更新指定的欄位，不會覆蓋整個文件\n    await updateDoc(postRef, {\n      comments: [...existingComments, newComment],\n      commentCount: existingComments.length + 1\n    });\n    console.log('✅ 留言已成功新增');\n  } catch (error) {\n    console.error('❌ 新增留言時發生錯誤:', error);\n    throw error;\n  }\n};\n\n// ==========================================\n// 🔹 功能 4：取得單一貼文（用於貼文詳情頁）\n// ==========================================\n/**\n * 取得單一貼文的完整資料\n *\n * @param {string} postId - 貼文 ID\n * @returns {Promise<object>} 貼文資料\n */\nexport const getPostById = async postId => {\n  try {\n    const q = query(collection(db, 'posts'), where('__name__', '==', postId));\n    const snapshot = await getDocs(q);\n    if (snapshot.empty) {\n      throw new Error('找不到指定的貼文');\n    }\n    const doc = snapshot.docs[0];\n    return {\n      id: doc.id,\n      ...doc.data()\n    };\n  } catch (error) {\n    console.error('❌ 取得貼文時發生錯誤:', error);\n    throw error;\n  }\n};\n\n// ==========================================\n// 📝 使用說明總結\n// ==========================================\n/*\n\n在 React 組件中的使用方式：\n\nimport { listenToPosts, createPost, addCommentToPost } from '../services/postService';\nimport { useAuth } from '../contexts/AuthContext';\n\nfunction BoardTemplate({ boardName }) {\n  const [posts, setPosts] = useState([]);\n  const { currentUser, userProfile } = useAuth();\n\n  // 1. 監聽貼文（組件載入時）\n  useEffect(() => {\n    const unsubscribe = listenToPosts(boardName, (newPosts) => {\n      setPosts(newPosts);\n    });\n\n    // 清理函數：組件卸載時停止監聽\n    return () => unsubscribe();\n  }, [boardName]);\n\n  // 2. 新增貼文\n  const handleSubmit = async (title, content, imageUrls) => {\n    try {\n      await createPost({\n        title,\n        content,\n        boardName,\n        authorId: currentUser.uid,\n        authorName: userProfile?.nickname || '匿名用戶',\n        imageUrls\n      });\n      // 不需要手動更新 posts state，onSnapshot 會自動觸發！\n    } catch (error) {\n      alert('發文失敗：' + error.message);\n    }\n  };\n\n  // 3. 新增留言\n  const handleAddComment = async (postId, content) => {\n    try {\n      await addCommentToPost(postId, {\n        author: userProfile?.nickname || '匿名用戶',\n        content\n      });\n      // 同樣不需要手動更新，onSnapshot 會自動觸發！\n    } catch (error) {\n      alert('留言失敗：' + error.message);\n    }\n  };\n\n  return (\n    // ... JSX\n  );\n}\n\n*/","map":{"version":3,"names":["collection","addDoc","getDocs","getDoc","query","where","orderBy","onSnapshot","doc","updateDoc","Timestamp","db","listenToPosts","boardName","callback","postsRef","q","unsubscribe","snapshot","posts","forEach","push","id","data","error","console","createPost","postData","newPost","title","content","authorId","authorName","imageUrls","createdAt","now","commentCount","comments","docRef","log","addCommentToPost","postId","comment","postRef","postSnapshot","exists","Error","existingComments","newComment","Date","toString","author","date","toLocaleString","length","getPostById","empty","docs"],"sources":["/Users/xueyulan/Desktop/IntroduceToTheInternet_FinalProject/src/services/postService.js"],"sourcesContent":["// src/services/postService.js\n// 這個檔案專門處理貼文相關的 Firestore 操作\n\nimport {\n  collection,      // 用來指定集合\n  addDoc,          // 新增文件\n  getDocs,         // 取得所有文件（一次性）\n  getDoc,          // 🔥 新增：取得單一文件\n  query,           // 建立查詢\n  where,           // 查詢條件\n  orderBy,         // 排序\n  onSnapshot,      // 即時監聽資料變化\n  doc,             // 指定特定文件\n  updateDoc,       // 更新文件\n  Timestamp        // Firestore 時間戳記\n} from 'firebase/firestore';\nimport { db } from '../firebase';\n\n// ==========================================\n// 📖 原理解說：\n// ==========================================\n// Firestore 的核心操作分為兩種：\n// 1. 「一次性讀取」：getDocs() - 只取得當下的資料\n// 2. 「即時監聽」：onSnapshot() - 資料有變化時自動更新\n\n// 我們會使用 onSnapshot()，這樣當其他用戶發文時\n// 你的畫面會自動即時更新！\n\n// ==========================================\n// 🔹 功能 1：取得指定看板的所有貼文（即時監聽）\n// ==========================================\n/**\n * 監聽指定看板的貼文，並在資料變化時即時更新\n *\n * @param {string} boardName - 看板名稱（例如 \"Food\"）\n * @param {function} callback - 當資料變化時會呼叫這個函數，傳入最新的貼文陣列\n * @returns {function} unsubscribe - 呼叫這個函數可以停止監聽\n *\n * 使用範例：\n * const unsubscribe = listenToPosts(\"Food\", (posts) => {\n *   console.log(\"收到最新貼文:\", posts);\n *   setPosts(posts); // 更新 React state\n * });\n *\n * // 當組件卸載時，停止監聽\n * return () => unsubscribe();\n */\nexport const listenToPosts = (boardName, callback) => {\n  try {\n    // 1. 建立對 posts collection 的參照\n    const postsRef = collection(db, 'posts');\n\n    // 2. 建立查詢：只取得指定看板的貼文，並按時間排序（新的在前）\n    const q = query(\n      postsRef,\n      where('boardName', '==', boardName),  // 篩選條件：看板名稱\n      orderBy('createdAt', 'desc')          // 排序：最新的在最上面\n    );\n\n    // 3. 開始監聽這個查詢\n    // 🔑 重點：onSnapshot 會在以下情況觸發：\n    //    - 第一次呼叫時（回傳現有資料）\n    //    - 有新貼文新增時\n    //    - 有貼文被修改時\n    //    - 有貼文被刪除時\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const posts = [];\n\n      // 4. 遍歷所有文件，將資料轉換成我們需要的格式\n      snapshot.forEach((doc) => {\n        posts.push({\n          id: doc.id,           // 文件 ID\n          ...doc.data()         // 文件內的所有資料\n        });\n      });\n\n      // 5. 呼叫 callback，把最新資料傳出去\n      callback(posts);\n    }, (error) => {\n      console.error('監聽貼文時發生錯誤:', error);\n      // 如果發生錯誤，回傳空陣列\n      callback([]);\n    });\n\n    // 6. 回傳取消監聽的函數\n    return unsubscribe;\n\n  } catch (error) {\n    console.error('設定監聽時發生錯誤:', error);\n    return () => {}; // 回傳空函數避免錯誤\n  }\n};\n\n\n// ==========================================\n// 🔹 功能 2：新增貼文到 Firestore\n// ==========================================\n/**\n * 新增一篇貼文到 Firestore\n *\n * @param {object} postData - 貼文資料\n * @param {string} postData.title - 標題\n * @param {string} postData.content - 內容\n * @param {string} postData.boardName - 看板名稱\n * @param {string} postData.authorId - 作者 UID\n * @param {string} postData.authorName - 作者名稱\n * @param {array} postData.imageUrls - 圖片網址陣列\n * @returns {Promise<string>} 回傳新建立的文件 ID\n *\n * 使用範例：\n * const newPostId = await createPost({\n *   title: \"美味午餐\",\n *   content: \"今天吃了好吃的拉麵\",\n *   boardName: \"Food\",\n *   authorId: currentUser.uid,\n *   authorName: \"小明\",\n *   imageUrls: [\"data:image/png;base64,...\"]\n * });\n */\nexport const createPost = async (postData) => {\n  try {\n    // 1. 準備要存入 Firestore 的資料\n    const newPost = {\n      title: postData.title,\n      content: postData.content,\n      boardName: postData.boardName,\n      authorId: postData.authorId,\n      authorName: postData.authorName,\n      imageUrls: postData.imageUrls || [],\n      createdAt: Timestamp.now(),      // 使用 Firestore 伺服器時間\n      commentCount: 0,                 // 初始留言數為 0\n      comments: []                     // 初始留言陣列為空\n    };\n\n    // 2. 將資料新增到 posts collection\n    // 🔑 重點：addDoc 會自動產生一個唯一的 document ID\n    const docRef = await addDoc(collection(db, 'posts'), newPost);\n\n    console.log('✅ 貼文已成功新增到 Firestore，ID:', docRef.id);\n\n    // 3. 回傳新建立的文件 ID\n    return docRef.id;\n\n  } catch (error) {\n    console.error('❌ 新增貼文時發生錯誤:', error);\n    throw error; // 將錯誤往上拋，讓呼叫的地方可以處理\n  }\n};\n\n\n// ==========================================\n// 🔹 功能 3：更新貼文的留言\n// ==========================================\n/**\n * 新增留言到指定的貼文\n *\n * @param {string} postId - 貼文 ID\n * @param {object} comment - 留言資料\n * @param {string} comment.author - 留言者名稱\n * @param {string} comment.content - 留言內容\n * @returns {Promise<void>}\n *\n * 使用範例：\n * await addCommentToPost(\"abc123\", {\n *   author: \"小華\",\n *   content: \"看起來好好吃！\"\n * });\n */\nexport const addCommentToPost = async (postId, comment) => {\n  try {\n    // 1. 取得指定貼文的參照\n    const postRef = doc(db, 'posts', postId);\n\n    // 2. 先取得現有的貼文資料 - 🔥 修正：使用 getDoc 而不是 getDocs\n    const postSnapshot = await getDoc(postRef);\n\n    if (!postSnapshot.exists()) {\n      throw new Error('找不到指定的貼文');\n    }\n\n    const postData = postSnapshot.data();\n    const existingComments = postData.comments || [];\n\n    // 3. 準備新留言資料\n    const newComment = {\n      id: Date.now().toString(),\n      author: comment.author,\n      content: comment.content,\n      date: new Date().toLocaleString('zh-TW')\n    };\n\n    // 4. 更新貼文：新增留言並增加留言數量\n    // 🔑 重點：updateDoc 只會更新指定的欄位，不會覆蓋整個文件\n    await updateDoc(postRef, {\n      comments: [...existingComments, newComment],\n      commentCount: existingComments.length + 1\n    });\n\n    console.log('✅ 留言已成功新增');\n\n  } catch (error) {\n    console.error('❌ 新增留言時發生錯誤:', error);\n    throw error;\n  }\n};\n\n\n// ==========================================\n// 🔹 功能 4：取得單一貼文（用於貼文詳情頁）\n// ==========================================\n/**\n * 取得單一貼文的完整資料\n *\n * @param {string} postId - 貼文 ID\n * @returns {Promise<object>} 貼文資料\n */\nexport const getPostById = async (postId) => {\n  try {\n    const q = query(collection(db, 'posts'), where('__name__', '==', postId));\n    const snapshot = await getDocs(q);\n\n    if (snapshot.empty) {\n      throw new Error('找不到指定的貼文');\n    }\n\n    const doc = snapshot.docs[0];\n    return {\n      id: doc.id,\n      ...doc.data()\n    };\n\n  } catch (error) {\n    console.error('❌ 取得貼文時發生錯誤:', error);\n    throw error;\n  }\n};\n\n\n// ==========================================\n// 📝 使用說明總結\n// ==========================================\n/*\n\n在 React 組件中的使用方式：\n\nimport { listenToPosts, createPost, addCommentToPost } from '../services/postService';\nimport { useAuth } from '../contexts/AuthContext';\n\nfunction BoardTemplate({ boardName }) {\n  const [posts, setPosts] = useState([]);\n  const { currentUser, userProfile } = useAuth();\n\n  // 1. 監聽貼文（組件載入時）\n  useEffect(() => {\n    const unsubscribe = listenToPosts(boardName, (newPosts) => {\n      setPosts(newPosts);\n    });\n\n    // 清理函數：組件卸載時停止監聽\n    return () => unsubscribe();\n  }, [boardName]);\n\n  // 2. 新增貼文\n  const handleSubmit = async (title, content, imageUrls) => {\n    try {\n      await createPost({\n        title,\n        content,\n        boardName,\n        authorId: currentUser.uid,\n        authorName: userProfile?.nickname || '匿名用戶',\n        imageUrls\n      });\n      // 不需要手動更新 posts state，onSnapshot 會自動觸發！\n    } catch (error) {\n      alert('發文失敗：' + error.message);\n    }\n  };\n\n  // 3. 新增留言\n  const handleAddComment = async (postId, content) => {\n    try {\n      await addCommentToPost(postId, {\n        author: userProfile?.nickname || '匿名用戶',\n        content\n      });\n      // 同樣不需要手動更新，onSnapshot 會自動觸發！\n    } catch (error) {\n      alert('留言失敗：' + error.message);\n    }\n  };\n\n  return (\n    // ... JSX\n  );\n}\n\n*/\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}